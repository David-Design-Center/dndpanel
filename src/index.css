@tailwind base;
@tailwind components;
@tailwind utilities;

/* Panel Animation Keyframes */
@keyframes slideInFromLeft {
  from {
    transform: translateX(-100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slideOutToLeft {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(-100%);
    opacity: 0;
  }
}

@keyframes slideInFromRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slideOutToRight {
  from {
    transform: translateX(0);
    opacity: 1;
  }
  to {
    transform: translateX(100%);
    opacity: 0;
  }
}

/* Panel Animation Classes */
.panel-slide-in-left {
  animation: slideInFromLeft 0.5s ease-in-out;
}

.panel-slide-out-left {
  animation: slideOutToLeft 0.5s ease-in-out;
}

.panel-slide-in-right {
  animation: slideInFromRight 0.5s ease-in-out;
}

.panel-slide-out-right {
  animation: slideOutToRight 0.5s ease-in-out;
}

/* Smooth width transitions for folders column - Slower, smoother animation */
.folders-column-collapsed {
  width: 48px;
  min-width: 48px;
  max-width: 48px;
  overflow: hidden;
  transition: width 0.4s ease-out;
}

.folders-column-expanded {
  width: 100%;
  min-width: 200px;
  overflow: hidden;
  transition: width 0.4s ease-out;
}

/* Content visibility - No animations, just instant show/hide */
.folders-content-collapsed {
  display: none;
}

.folders-content-expanded {
  display: block;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(-10px);
  }
}

/* Resize Handle Improvements - Sharp border styling to match folders column */
[data-panel-resize-handle] {
  position: relative;
  background-color: #9ca3af !important;
  transition: background-color 0.15s ease;
  z-index: 10;
  border: none;
  width: 2px !important;
  min-width: 2px !important;
  max-width: 2px !important;
}

[data-panel-resize-handle]:hover {
  background-color: #6b7280 !important;
}

[data-panel-resize-handle]:active {
  background-color: #4b5563 !important;
}

/* Ensure panels don't overlap */
.panel-group {
  position: relative;
  overflow: hidden;
}

/* Vertical text for collapsed folders */
.writing-mode-vertical {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
}

/* Invoice preview scaling for two-column layout */
.invoice-preview-wrapper {
  transform-origin: top left;
  transform: scale(0.6);
  width: 166.67%; /* 100% / 0.6 to compensate for scale */
  overflow: hidden;
}

@media (max-width: 1024px) {
  .invoice-preview-wrapper {
    transform: scale(0.5);
    width: 200%; /* 100% / 0.5 to compensate for scale */
  }
}

/* Email content styling - handle images and prevent overflow */
.email-content {
  overflow-wrap: break-word;
  word-wrap: break-word;
  hyphens: auto;
  font-size: 0.875rem; /* 14px */
  line-height: 1.5;
}

.email-content p {
  font-size: 0.875rem !important; /* 14px */
  line-height: 1.5 !important;
  margin-bottom: 0.75rem !important;
}

.email-content h1, .email-content h2, .email-content h3, .email-content h4, .email-content h5, .email-content h6 {
  font-size: 1rem !important; /* 16px for headings */
  margin-bottom: 0.5rem !important;
  margin-top: 1rem !important;
}

.email-content img {
  max-width: 100% !important;
  height: auto !important;
  display: block !important;
  margin: 8px 0 !important;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.email-content table {
  max-width: 100% !important;
  table-layout: auto !important;
  word-break: break-word !important;
  overflow-x: auto;
}

.email-content * {
  max-width: 100% !important;
}

/* Email tabs styling */
.email-tabs [data-state=active] {
  border-bottom: 2px solid #3b82f6 !important;
  position: relative;
}

.email-tabs [data-state=active]::after {
  content: '';
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
  height: 2px;
  background-color: #3b82f6;
}

/* Strong email content isolation to prevent style leakage while preserving email appearance */

/* Settings expandable sections - compact styling */
.settings-expandable-content {
  font-size: 0.75rem; /* 12px */
  line-height: 1.2;
}

.settings-expandable-content input,
.settings-expandable-content textarea,
.settings-expandable-content select,
.settings-expandable-content button {
  font-size: 0.75rem !important;
  padding: 0.25rem 0.5rem !important;
  min-height: 1.5rem !important;
}

.settings-expandable-content .rich-text-editor [contenteditable] {
  font-size: 0.75rem !important;
  line-height: 1.2 !important;
  padding: 0.25rem !important;
  min-height: 2rem !important;
}

.settings-expandable-content .rich-text-toolbar {
  padding: 0.125rem !important;
}

.settings-expandable-content .rich-text-toolbar button {
  padding: 0.125rem 0.25rem !important;
  font-size: 0.625rem !important;
  min-height: 1.25rem !important;
}

.settings-expandable-content h1,
.settings-expandable-content h2,
.settings-expandable-content h3,
.settings-expandable-content h4 {
  font-size: 0.75rem !important;
  margin: 0.25rem 0 !important;
}

.settings-expandable-content p,
.settings-expandable-content div,
.settings-expandable-content span {
  font-size: 0.75rem !important;
  margin: 0.125rem 0 !important;
}

.settings-expandable-content .space-y-4 > * + * {
  margin-top: 0.5rem !important;
}

.settings-expandable-content .space-y-3 > * + * {
  margin-top: 0.375rem !important;
}

.settings-expandable-content .space-y-2 > * + * {
  margin-top: 0.25rem !important;
}

.settings-expandable-content .mb-4 {
  margin-bottom: 0.5rem !important;
}

.settings-expandable-content .mb-3 {
  margin-bottom: 0.375rem !important;
}

.settings-expandable-content .mb-2 {
  margin-bottom: 0.25rem !important;
}

.settings-expandable-content .p-4 {
  padding: 0.5rem !important;
}

.settings-expandable-content .p-3 {
  padding: 0.375rem !important;
}

.settings-expandable-content .p-2 {
  padding: 0.25rem !important;
}

.settings-expandable-content .py-2 {
  padding-top: 0.25rem !important;
  padding-bottom: 0.25rem !important;
}

.settings-expandable-content .px-3 {
  padding-left: 0.375rem !important;
  padding-right: 0.375rem !important;
}

.settings-expandable-content .rounded-lg {
  border-radius: 0.25rem !important;
}

/* Animation for settings sections */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-fadeIn {
  animation: fadeIn 0.2s ease-out forwards;
}
.email-isolation-container {
  /* Create an ultra-strong isolation boundary */
  isolation: isolate;
  contain: layout style paint size;
  overflow: hidden;
  position: relative;
  
  /* Create a completely isolated stacking context */
  transform: translateZ(0);
  will-change: transform;
  
  /* Reset and lock down the container */
  display: block !important;
  width: 100% !important;
  height: auto !important;
  box-sizing: border-box !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif !important;
  background: white !important;
  border-radius: 0.5rem !important;
  padding: 1rem !important;
  margin: 0 !important;
  
  /* Prevent any email styles from bubbling up */
  z-index: 0 !important;
}

/* Isolate all children of email content */
.email-isolation-container * {
  /* Reset dangerous properties that could affect parent elements */
  position: static !important;
  z-index: auto !important;
  
  /* Prevent layout escape */
  max-width: 100% !important;
  box-sizing: border-box !important;
  
  /* Lock font inheritance */
  font-family: inherit !important;
}

/* Additional wrapper for email content */
.email-content-wrapper {
  /* Create another isolation boundary */
  isolation: isolate !important;
  contain: layout style paint !important;
  position: relative !important;
  z-index: 0 !important;
  display: block !important;
  width: 100% !important;
  overflow: hidden !important;
}

/* Lock down email body content specifically */
.email-body-content {
  /* Prevent any styles from leaking out */
  isolation: isolate !important;
  contain: layout style paint !important;
  position: relative !important;
  z-index: auto !important;
  display: block !important;
  
  /* Completely isolate all child elements */
  transform: translateZ(0) !important;
  will-change: transform !important;
}

.email-body-content * {
  /* Force containment for all email elements */
  position: static !important;
  z-index: auto !important;
  max-width: 100% !important;
  overflow: visible !important;
  
  /* Prevent font and color inheritance issues */
  font-family: inherit !important;
  color: inherit !important;
}

/* Global protection against email style leakage */
.email-isolation-container h1,
.email-isolation-container h2,
.email-isolation-container h3,
.email-isolation-container h4,
.email-isolation-container h5,
.email-isolation-container h6 {
  /* Reset heading styles that emails might override */
  font-size: inherit !important;
  font-weight: bold !important;
  margin: 0.5em 0 !important;
  line-height: 1.4 !important;
  color: inherit !important;
}

.email-isolation-container p {
  margin: 0.5em 0 !important;
  line-height: 1.5 !important;
  color: inherit !important;
}

.email-isolation-container div,
.email-isolation-container span,
.email-isolation-container table,
.email-isolation-container td,
.email-isolation-container th {
  /* Prevent email CSS from escaping the container */
  max-width: 100% !important;
  box-sizing: border-box !important;
  position: static !important;
  z-index: auto !important;
  background-attachment: local !important;
}

/* Isolated Email Content - Ultimate Protection */
.isolated-email-content {
  /* Create the strongest possible isolation boundary */
  isolation: isolate !important;
  contain: layout style paint size !important;
  overflow: hidden !important;
  position: relative !important;
  z-index: 0 !important;
  transform: translateZ(0) !important;
  will-change: transform !important;
  
  /* Lock down dimensions */
  display: block !important;
  width: 100% !important;
  height: auto !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
  
  /* Prevent any style leakage */
  background: white !important;
  color: #374151 !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif !important;
  font-size: 14px !important;
  line-height: 1.5 !important;
}

/* Force complete isolation for all children */
.isolated-email-content * {
  /* Remove all dangerous properties */
  position: static !important;
  z-index: auto !important;
  top: auto !important;
  left: auto !important;
  right: auto !important;
  bottom: auto !important;
  
  /* Lock sizing */
  max-width: 100% !important;
  box-sizing: border-box !important;
  
  /* Prevent inheritance issues */
  font-family: inherit !important;
  color: inherit !important;
  background-attachment: local !important;
  
  /* Remove any potential transform or animation issues */
  transform: none !important;
  animation: none !important;
  transition: none !important;
}

/* Specifically target elements that commonly cause issues */
.isolated-email-content div,
.isolated-email-content span,
.isolated-email-content p,
.isolated-email-content table,
.isolated-email-content td,
.isolated-email-content th,
.isolated-email-content img {
  /* Ultimate lockdown */
  position: static !important;
  z-index: auto !important;
  max-width: 100% !important;
  overflow: visible !important;
}

.email-body-content {
  /* Allow email content to use its original styles */
  all: revert;
  
  /* But constrain dimensions and positioning */
  max-width: 100% !important;
  width: 100% !important;
  box-sizing: border-box !important;
  
  /* Prevent email images from breaking layout */
  img {
    max-width: 100% !important;
    height: auto !important;
  }
  
  /* Ensure email tables don't break layout */
  table {
    max-width: 100% !important;
    width: auto !important;
  }
  
  /* Prevent dangerous positioning that could break out of container - ONLY within email content */
  * {
    position: static !important;
    z-index: auto !important;
  }
  
  /* Prevent fixed/absolute positioning - ONLY within email content */
  [style*="position: fixed"],
  [style*="position: absolute"] {
    position: relative !important;
  }
  
  /* Prevent overflow that could break the container - ONLY within email content */
  body, html {
    overflow: visible !important;
    width: auto !important;
    height: auto !important;
  }
}

/* Exception: Allow modals and overlays to work properly outside email content */
/* These rules must be more specific than the email content rules above */
body > div[class*="fixed"],
body > .fixed,
div[class*="z-50"],
.fixed.inset-0,
[style*="position: fixed"][class*="z-"],
[class*="modal"],
[class*="overlay"],
[data-modal] {
  position: fixed !important;
  z-index: 50 !important;
}

/* Ensure modal backdrops work */
div[class*="bg-black"][class*="fixed"] {
  position: fixed !important;
  z-index: 50 !important;
}

/* Ensure modal content containers work */
div[class*="flex"][class*="min-h-full"] {
  position: fixed !important;
  z-index: 50 !important;
}

@layer base {
  html {
    @apply text-gray-900;
  }
  
  body {
    @apply bg-gray-50 font-sans;
  }
  
  h1, h2, h3, h4, h5, h6 {
    @apply font-medium;
  }
  :root {
    --background: 0 0% 100%;
    --foreground: 224 71.4% 4.1%;
    --card: 0 0% 100%;
    --card-foreground: 224 71.4% 4.1%;
    --popover: 0 0% 100%;
    --popover-foreground: 224 71.4% 4.1%;
    --primary: 220.9 39.3% 11%;
    --primary-foreground: 210 20% 98%;
    --secondary: 220 14.3% 95.9%;
    --secondary-foreground: 220.9 39.3% 11%;
    --muted: 220 14.3% 95.9%;
    --muted-foreground: 220 8.9% 46.1%;
    --accent: 220 14.3% 95.9%;
    --accent-foreground: 220.9 39.3% 11%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 20% 98%;
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 224 71.4% 4.1%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
    --skeleton: hsl(0, 0%, 90%);
    --btn-border: hsl(214deg, 31.8%, 91.4%);
  }
  .dark {
    --background: 224 71.4% 4.1%;
    --foreground: 210 20% 98%;
    --card: 224 71.4% 4.1%;
    --card-foreground: 210 20% 98%;
    --popover: 224 71.4% 4.1%;
    --popover-foreground: 210 20% 98%;
    --primary: 210 20% 98%;
    --primary-foreground: 220.9 39.3% 11%;
    --secondary: 215 27.9% 16.9%;
    --secondary-foreground: 210 20% 98%;
    --muted: 215 27.9% 16.9%;
    --muted-foreground: 217.9 10.6% 64.9%;
    --accent: 215 27.9% 16.9%;
    --accent-foreground: 210 20% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 20% 98%;
    --border: 215 27.9% 16.9%;
    --input: 215 27.9% 16.9%;
    --ring: 216 12.2% 83.9%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
    --skeleton: hsl(218, 36%, 16%);
    --btn-border: hsl(217deg, 32.6%, 17.5%);
  }
}

@layer components {
  .btn {
    @apply px-4 py-2 rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50;
  }
  
  .btn-primary {
    @apply bg-blue-500 text-white hover:bg-blue-600;
  }
  
  .btn-secondary {
    @apply bg-gray-200 text-gray-800 hover:bg-gray-300;
  }
  
  .input {
    @apply w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500;
  }
  
  .card {
    @apply bg-white rounded-lg shadow-sm p-4;
  }
  
  .g-button {
    @apply rounded-[var(--radius)] border;
    border-color: var(--btn-border)
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.slide-in {
  animation: slideIn 0.3s ease-in-out;
}

@keyframes slideIn {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

/* Email body content specific styles */
.email-body-content {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  line-height: 1.6;
  color: #333;
}

/* Remove unwanted borders from email content elements */
.email-body-content *,
.email-body-content div,
.email-body-content p,
.email-body-content span,
.email-body-content section,
.email-body-content article,
.email-body-content header,
.email-body-content footer,
.email-body-content main,
.email-body-content aside {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}

.email-body-content img {
  max-width: 100%;
  height: auto;
  border: none !important;
  outline: none !important;
}

.email-body-content a {
  color: #2563eb;
  text-decoration: underline;
  border: none !important;
  outline: none !important;
}

.email-body-content table {
  border-collapse: collapse;
  margin: 1em 0;
  border: none !important;
}

.email-body-content th, 
.email-body-content td {
  border: none !important;
  padding: 0.5em;
  outline: none !important;
}

/* Special handling for table borders if they're actually needed */
.email-body-content table[border],
.email-body-content table[style*="border"] {
  border-collapse: collapse;
}

.email-body-content table[border] th,
.email-body-content table[border] td,
.email-body-content table[style*="border"] th,
.email-body-content table[style*="border"] td {
  border: 1px solid #e5e7eb;
}

/* Invoice capture styles */
.invoice-printable-area {
  /* These styles are now handled by .invoice-document in print media query */
  /* and by .invoice-preview-wrapper for on-screen display */
  display: none; /* Remove if not used elsewhere */
}

.capturing-invoice .hide-for-capture {
  display: none !important;
}

/* Invoice preview wrapper for on-screen scaling */
.invoice-preview-wrapper {
  transform: scale(0.5);
  transform-origin: top left;
  /* Set explicit dimensions for the wrapper to contain the scaled content */
  width: 794px; /* Original width of the invoice document */
  height: 1123px; /* Original height of the invoice document */
  overflow: hidden; /* Hide content outside these dimensions */
  /* Add a border or shadow to make the preview stand out */
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
}

/* Enhanced print styles */
@media print {
  /* Hide everything except the invoice */
  * {
    visibility: hidden !important;
  }

  /* Make the invoice document and its children visible */
  .invoice-document,
  .invoice-document * {
    visibility: visible !important;
  }

  /* Reset body styles for printing */
  body {
    background-color: white !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: visible !important;
  }

  /* Position the invoice document to fill the page */
  .invoice-document {
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    width: 210mm !important; /* A4 width */
    height: auto !important;
    margin: 0 !important;
    padding: 20mm !important; /* Standard page margins */
    box-shadow: none !important;
    background: white !important;
    transform: none !important;
    font-size: 12pt !important; /* Better print font size */
  }

  /* Remove the preview wrapper scaling */
  .invoice-preview-wrapper {
    transform: none !important;
    width: auto !important;
    height: auto !important;
    overflow: visible !important;
    border: none !important;
    box-shadow: none !important;
  }

  
  /* Enhanced print styles for better readability */
  .invoice-document table,
  .invoice-document th,
  .invoice-document td {
    border: 1px solid #000 !important;
    border-collapse: collapse !important;
  }
  
  .invoice-document .font-bold,
  .invoice-document strong {
    font-weight: bold !important;
  }
  
  .invoice-document .font-semibold {
    font-weight: 600 !important;
  }

  /* Ensure text is crisp and readable */
  .invoice-document {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Rich Text Editor Styles */
.rich-text-editor {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
}

.rich-text-editor [contenteditable] {
  line-height: 1.6;
  color: #374151;
}

.rich-text-editor [contenteditable]:empty:before {
  content: attr(data-placeholder);
  color: #9ca3af;
  pointer-events: none;
  font-style: italic;
}

.rich-text-editor [contenteditable] ul,
.rich-text-editor [contenteditable] ol {
  margin: 0.5em 0;
  padding-left: 1.5em;
}

.rich-text-editor [contenteditable] li {
  margin: 0.25em 0;
}

.rich-text-editor [contenteditable] a {
  color: #3b82f6;
  text-decoration: underline;
}

.rich-text-editor [contenteditable] a:hover {
  color: #1d4ed8;
}

.rich-text-editor [contenteditable] strong,
.rich-text-editor [contenteditable] b {
  font-weight: 600;
}

.rich-text-editor [contenteditable] em,
.rich-text-editor [contenteditable] i {
  font-style: italic;
}

.rich-text-editor [contenteditable] u {
  text-decoration: underline;
}

.rich-text-editor [contenteditable] img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 10px auto;
  border-radius: 4px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Image size variants for Gmail compatibility */
.rich-text-editor [contenteditable] .inline-image-small {
  max-width: 200px !important;
  width: 200px !important;
}

.rich-text-editor [contenteditable] .inline-image-medium {
  max-width: 400px !important;
  width: 400px !important;
}

.rich-text-editor [contenteditable] .inline-image-large {
  max-width: 600px !important;
  width: 600px !important;
}

.rich-text-editor [contenteditable] .inline-image-full {
  max-width: 100% !important;
  width: 100% !important;
}

/* Ensure image size picker appears above other content */
.image-size-picker .absolute {
  z-index: 50;
}

.rich-text-editor [contenteditable]:focus {
  outline: none;
}

/* Toolbar button styling consistency */
.rich-text-toolbar button {
  transition: all 0.2s ease;
}

.rich-text-toolbar button:hover {
  background-color: #f3f4f6;
}

.rich-text-toolbar button[data-state="on"] {
  background-color: #e5e7eb;
  color: #374151;
}

/* Text highlight styles */
.rich-text-editor [contenteditable] span[style*="background-color"] {
  border-radius: 2px;
  padding: 1px 2px;
}

/* Ensure highlight color picker appears above other content */
.highlight-color-picker .absolute {
  z-index: 50;
}

/* Custom scrollbar styles for sidebar folders panel */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e1 #f8fafc;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: #f8fafc;
  border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

.custom-scrollbar::-webkit-scrollbar-corner {
  background: #f8fafc;
}

/* Resizable panel handles */
.resize-handle {
  position: relative;
  background-color: transparent;
  transition: all 0.2s ease;
}

.resize-handle:hover {
  background-color: #3b82f6;
}

.resize-handle:active {
  background-color: #2563eb;
}

.resize-handle::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 2px;
  height: 20px;
  background-color: #d1d5db;
  border-radius: 1px;
  transition: background-color 0.2s ease;
}

.resize-handle:hover::before {
  background-color: white;
}

/* Smooth resizable panel transitions with enhanced performance */
[data-panel-group] {
  transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
}

[data-panel] {
  transition: width 0.3s cubic-bezier(0.4, 0.0, 0.2, 1),
              min-width 0.3s cubic-bezier(0.4, 0.0, 0.2, 1),
              max-width 0.3s cubic-bezier(0.4, 0.0, 0.2, 1),
              transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
  will-change: transform, width;
}

/* Enhanced folder column animations */
[data-panel]:first-child {
  transform-origin: left center;
  transition: width 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
}

/* Force collapsed width styling - Universal 4% for any screen */
[data-panel]:first-child.folders-collapsed {
  width: 4% !important;
  max-width: 4% !important;
  min-width: 4% !important;
  flex: 0 0 4% !important;
  overflow: visible; /* Allow the outline to show */
}

/* Collapsed folders styling */
.folders-collapsed {
  position: relative;
}

.folders-collapsed::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 2px;
  background: linear-gradient(to bottom, #e5e7eb, #d1d5db, #e5e7eb);
  z-index: 1;
}

/* Additional safety net for very small widths - MacBook-optimized */
[data-panel]:first-child[style*="width: 4.4%"] {
  overflow: hidden;
}

/* Hide resize handle when folders are collapsed with smooth transition */
[data-panel-group]:has([data-panel]:first-child[data-panel-size="4"]) [data-panel-resize-handle] {
  opacity: 0;
  pointer-events: none;
  width: 0 !important;
  min-width: 0 !important;
  transition: opacity 0.3s ease, width 0.3s ease;
}

/* Remove gaps when folders are collapsed */
[data-panel-group]:has([data-panel]:first-child[data-panel-size="4"]) {
  gap: 0;
}

/* Enhanced panel alignment and professional appearance with text truncation */
[data-panel-group] {
  overflow: hidden !important; /* Prevent page-level scrolling */
  max-width: 100vw !important;
  width: 100% !important;
  height: 100% !important;
  box-sizing: border-box !important;
  align-items: stretch !important; /* Ensure all panels have same height */
}

[data-panel] {
  overflow: hidden !important; /* Contain each panel */
  max-width: 100% !important;
  height: 100% !important;
  box-sizing: border-box !important;
  display: flex !important;
  flex-direction: column !important;
  min-width: 0 !important; /* Critical for text truncation */
}

/* Specific constraints for email list panel (middle panel) */
[data-panel]:nth-child(2) {
  max-width: min(600px, 50vw) !important; /* Constrain inbox width */
  overflow: hidden !important;
}

/* When email panel is open, make inbox even narrower */
[data-panel-group]:has([data-panel]:nth-child(4)) [data-panel]:nth-child(2) {
  max-width: min(450px, 35vw) !important; /* Narrower when email is open */
}

/* Force all content within panels to respect width limits */
[data-panel] > * {
  max-width: 100% !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
}

/* Email content container - prevent overflow in ViewEmail */
.email-content-container {
  max-width: 100% !important;
  overflow: hidden !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
}

.email-content-container iframe {
  max-width: 100% !important;
  width: 100% !important;
  border: none !important;
  border-radius: 8px !important;
  overflow: hidden !important;
}

/* Line clamp utility for better text truncation */
.line-clamp-3 {
  display: -webkit-box !important;
  -webkit-line-clamp: 3 !important;
  line-clamp: 3 !important;
  -webkit-box-orient: vertical !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

/* Break words utility for long text content */
.break-words {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  word-break: break-word !important;
  hyphens: auto !important;
}

/* Specific email panel containment */
[data-panel]:last-child {
  overflow: hidden !important;
  max-width: 100% !important;
  height: 100% !important;
  contain: layout style size !important;
}

/* Email content within panels must be contained */
[data-panel] .email-content,
[data-panel] .email-view,
[data-panel] [class*="email"] {
  max-width: 100% !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
}

/* Ensure all column content takes full height and aligns properly */
[data-panel] > div {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  min-width: 0 !important; /* Critical for text truncation */
  overflow: hidden !important; /* Contain content within panel */
}

/* Force folders column to match height and align borders */
[data-panel]:first-child > div {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  border-right: 1px solid var(--border, #e5e7eb) !important;
  min-width: 0 !important;
  overflow: hidden !important; /* Prevent folders from overflowing */
}

/* Force inbox column to match height and maintain border alignment */
[data-panel]:nth-child(2) > div {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  border-right: 1px solid var(--border, #e5e7eb) !important;
  min-width: 0 !important;
  overflow: hidden !important; /* Prevent inbox from overflowing */
}

/* Force email view column to match height */
[data-panel]:last-child > div {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  min-width: 0 !important;
  overflow: hidden !important; /* Prevent email view from overflowing */
}

/* Professional border alignment - remove duplicate borders */
[data-panel]:first-child .border-r {
  border-right: none !important;
}

[data-panel]:nth-child(2) .border-r {
  border-right: none !important;
}

/* Ensure professional spacing and alignment */
.panel-group {
  gap: 0 !important;
  border: none !important;
}

/* Universal text truncation rules for all panel content */
[data-panel] * {
  box-sizing: border-box !important;
}

/* Text truncation for any text elements within panels */
[data-panel] .truncate {
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
}

/* Force truncation for common text containers - but exclude scrollable areas */
[data-panel] span:not(.flex-shrink-0):not([class*="w-"]):not([class*="h-"]):not([class*="overflow"]),
[data-panel] p:not(.flex-shrink-0):not([class*="overflow"]),
[data-panel] h1:not(.flex-shrink-0):not([class*="overflow"]),
[data-panel] h2:not(.flex-shrink-0):not([class*="overflow"]),
[data-panel] h3:not(.flex-shrink-0):not([class*="overflow"]),
[data-panel] h4:not(.flex-shrink-0):not([class*="overflow"]) {
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  min-width: 0 !important;
}

/* Exception: Don't apply truncation to elements that should scroll */
[data-panel] .overflow-y-auto *,
[data-panel] [class*="overflow-y-auto"] * {
  overflow: visible !important;
  text-overflow: clip !important;
  white-space: normal !important;
}

/* Ensure flex containers handle text truncation properly */
[data-panel] .flex {
  min-width: 0 !important;
}

[data-panel] .flex-1 {
  min-width: 0 !important;
  /* Allow vertical scrolling, only prevent horizontal overflow */
}

/* Exception: Allow overflow-y-auto elements to scroll INTERNALLY */
[data-panel] .overflow-y-auto {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  /* These elements can scroll within their containers */
}

/* Exception: Allow specific scrollable containers */
[data-panel] .flex-1.overflow-y-auto,
[data-panel] [class*="overflow-y-auto"] {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  /* Internal scrolling allowed */
}

/* CRITICAL: Ensure email list containers can scroll WITHIN their panel */
[data-panel] .bg-white.rounded-lg.shadow-sm .flex-1.overflow-y-auto,
[data-panel] .bg-white.rounded-lg.shadow-sm .overflow-y-auto,
[data-panel] .flex-1.overflow-y-auto.max-w-full {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  max-height: none !important;
  /* This allows the email list to scroll within the inbox panel */
}

/* CRITICAL: Allow all children of scrollable containers to have normal overflow */
[data-panel] .overflow-y-auto *,
[data-panel] .flex-1.overflow-y-auto *,
[data-panel] [class*="overflow-y-auto"] * {
  overflow: visible !important;
  text-overflow: clip !important;
  white-space: normal !important;
  /* Children of scrollable containers should not be truncated */
}

/* CRITICAL: Force email list scrolling to work properly */
.email-list-container {
  height: 0 !important;
  flex: 1 1 0% !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  min-height: 0 !important;
  max-height: none !important;
}

/* Ensure email list containers can scroll WITHIN their panel */
[data-panel] .bg-white.rounded-lg.shadow-sm .flex-1.overflow-y-auto {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  max-height: none !important;
  /* This allows the email list to scroll within the inbox panel */
}

/* Ensure folders list can scroll WITHIN its panel */
[data-panel] .flex-1.overflow-y-auto.custom-scrollbar {
  overflow-y: auto !important;
  overflow-x: hidden !important;
  max-height: none !important;
  /* This allows the folders list to scroll within the folders panel */
}

/* Override any restrictive overflow rules for scrollable content - SCOPED TO PANELS ONLY */
[data-panel] .overflow-y-auto {
  overflow-y: auto !important;
}

[data-panel] .overflow-x-hidden {
  overflow-x: hidden !important;
}

/* Force scrollable behavior on main email containers - WITHIN PANELS ONLY */
[data-panel] .bg-white.rounded-lg.shadow-sm,
[data-panel] .bg-white.rounded-lg.shadow-sm .flex-1 {
  overflow-y: auto !important;
  overflow-x: hidden !important;
}

/* Specific fixes for sidebar text truncation */
aside .flex.items-center {
  min-width: 0 !important;
  overflow: hidden !important;
}

aside .flex.items-center span:not(.flex-shrink-0) {
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  min-width: 0 !important;
}

/* Prevent unwanted layout shifts during animations */
[data-panel-group] > * {
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Smooth layout transitions for email panel changes */
.layout-transition {
  transition: all 0.3s ease-in-out;
}

/* Email view isolation - prevents email styles from affecting the app */
.email-view-isolation {
  isolation: isolate;
  contain: layout style paint;
  position: relative;
  z-index: 1;
}

.resize-handle:active::before {
  background-color: white;
}

/* Thread view improvements */
.line-clamp-1 {
  display: -webkit-box;
  -webkit-line-clamp: 1;
  line-clamp: 1;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.text-muted-foreground {
  color: rgb(107, 114, 128); /* gray-500 */
}

.bg-muted\/20 {
  background-color: rgba(249, 250, 251, 0.2); /* gray-50 with opacity */
}

.bg-muted\/30 {
  background-color: rgba(249, 250, 251, 0.3); /* gray-50 with opacity */
}

.ring-primary\/20 {
  --tw-ring-color: rgba(59, 130, 246, 0.2); /* blue-500 with opacity */
  box-shadow: 0 0 0 1px var(--tw-ring-color);
}
